/* 2015-06-17 */ !function(a){function b(b,g){function l(b,c){J=a.extend({},j,b),f(J,j),"auto"==J.type?J.type=G():"fixedWidth"!=J.type&&(J.type="grid"),a.easing[J.easing]||(J.easing=j.easing),J.duration<=0&&(J.duration=j.duration),T=E("width"),U=E("height"),c||m()}function m(a){console.log("activeFn"),"undefined"==typeof a&&(a=J.duration),t(),n(),q(a),o(a),u(a)}function n(){V=0,"grid"==J.type?(P=[],P.push(B(M,L)),K.each(function(b,c){var d=a(c);if(d.length){var e,f,g,h,i,j,k,l=Math.ceil(d.outerWidth(!0)/(M+T)),m=Math.ceil(d.outerHeight(!0)/(N+U)),n=!1;for(e=0;e<P.length;e++){for(f=0;f<P[e].length;f++){if(j=0===P[e][f]&&f+l<=P[e].length){var o=0;for(g=f;g<P[e].length;g++)if(o++,l>=o&&1==P[e][g]){j=!1;break}}if(j&&(k=e==P.length-1||1==m,!k)){var p=!0;for(g=e;g<P.length;g++)if(1==P[g][f]){p=!1;break}k=p}if(j&&k){n=!0;break}}if(n)break}for(n||(e=P.length,f=0),h=0;l>h;h++)for(i=0;m>i;i++)P[i+e]||P.push(B(M,L)),P[e+i][f+h]=1;d.data({"fallin.tx":f*(M+T),"fallin.ty":e*(N+U)}),f+h>V&&(V=f+h),J.containerHeightControl&&(Q=P.length*(N+U)-U)}})):"fixedWidth"==J.type&&(P=B(),K.each(function(b,c){var e=a(c),f=d(P);e.data({"fallin.tx":f*(M+T),"fallin.ty":P[f]}),P[f]+=e.outerHeight(!0)+U,V=b}),V=Math.min(V+1,P.length),J.containerHeightControl&&(Q=e(P)-U)),R=C()}function o(b){K.each(function(c,d){p(a(d),b)})}function p(a,b){a.stop();var d={left:a.data("fallin.tx")+R,top:a.data("fallin.ty")};c(d,a.position())||(b?a.animate(d,{easing:J.easing,duration:b}):a.css(d))}function q(a){if(J.containerHeightControl&&Q){var b={height:Q};a?X.stop().animate(b,{easing:J.easing,duration:a}):X.stop().css(b)}}function r(b,c){var d=a.extend({},{from:"default",fromElem:null,fromLeft:0,fromTop:0,effect:"default",duration:300},c);if("element"==d.from){var e=d.fromElem;e&&(e instanceof a||e.nodeName)||(d.from="default")}var f,g,i,j,k,l=h.added+d.effect,o=a(b).css("position","absolute").addClass(h.item),r=0,s=K;if("default"!=d.from&&(r=d.duration,k=d.delay),X.append(o.css("visibility","hidden")),k){w(),t(),n(),q(r),s.each(function(b,c){p(a(c),r)});var v=o.length;o.each(function(b,c){var e=a(c);setTimeout(function(){switch(d.from){case"left":f=0,g=X.height()+U;break;case"right":f=X.width()-D("height"),g=X.height()+U;break;case"end":var c=s.eq(-1);f=c.css("left"),g=c.css("top");break;case"pos":f=d.fromLeft,g=d.fromTop;break;case"element":i=a(d.fromElem).offset(),j=X.offset(),f=i.left-j.left,g=i.top-j.top}e.css({left:f,top:g,visibility:"visible"}).addClass(l),p(e,r),b==v-1&&(u(r),F(o))},d.delay*b)})}else o.addClass(l).css("visibility","visible"),m(r)}function s(b,c){if(b&&(c||(c="default"),b.constructor==String&&(b=X.find(b)),b instanceof a&&b.length)){var d=h.remove+c;b.addClass(d).addClass(h.ignore),setTimeout(function(){b.remove()},300),m()}}function t(){K=H(),L=X.width(),M=D("width"),N=D("height"),O=A()}function u(a){w(),J.fillEmpty&&"grid"==J.type&&(W&&clearTimeout(W),a?W=setTimeout(v,a):v())}function v(){if(J.fillEmpty&&"grid"==J.type){W&&clearTimeout(W);for(var b=D("width")+T,c=D("height")+U,d=0,e=P.length;e>d;d++)for(var f=0,g=P[d].length;g>f;f++)1!=P[d][f]&&X.append(a(i.empty).css({position:"absolute",left:f*b+R,top:d*c}))}}function w(){X.find("."+h.empty).remove()}function x(){a(window).bind("resize.fallin"+Y,function(){S&&clearTimeout(S),S=setTimeout(function(){var a=L!=X.width(),b=O!=A(),c=M!=D("width")||N!=D("height");(b||c||a&&"left"!=J.align)&&m()},30)})}function y(){a(window).unbind("resize.fallin"+Y)}function z(){return P}function A(){var a=X.width(),b=T,c=D("width"),d=Math.floor((a+b)/(c+b));return 1>d&&(d=1),d}function B(){for(var a=[],b=0,c=A();c>b;b++)a.push(0);return a}function C(){var a=0,b=X.width(),c=T,d=D("width"),e=V,f=b-(e*(d+c)-c);return"center"==J.align?a=f/2:"right"==J.align&&(a=f),a}function D(b){var c,d;if("height"==b?(c="gridHeight",d="outerHeight"):(c="gridWidth",d="outerWidth"),J[c])return J[c];var e=X.find("."+h.sizer),f=0;return e.length?(e.css("visibility","visible").show(),f=e[d](!0),e.css("visibility","hidden").hide()):(f=Number.MAX_VALUE,H().each(function(b,c){var e=a(c)[d](!0);e>=10&&f>e&&(f=e)}),f!=Number.MAX_VALUE&&f||(f=100)),f}function E(a){var b,c;return"height"==a?(b="marginHeight",c=["marginTop","marginBottom"]):(b="marginWidth",c=["marginLeft","marginRight"]),J[b]}function F(b,c){function d(){e==++g&&m(c)}var e,f=b.find("img"),g=0;f.length&&(e=f.length,f.each(function(b,c){a.ajax({url:a(c).attr("src"),success:d,error:d})}))}function G(){var b=0,c="fixedWidth";return H().each(function(d,e){var f=a(e).outerWidth();if(d){if(b!=f)return c="grid",!1}else b=f}),c}function H(){return X.find(J.itemSelector).filter(":not(."+h.sizer+",."+h.ignore+")")}function I(){return J}var J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=b instanceof a?b:a(b),Y=k++;l(g,!0),X.find("."+h.sizer).css("visibility","hidden").hide(),X.addClass(h.cont).css("position","relative").find("> *").css("position","absolute"),x();var Z=J.skipFirstMotion?0:J.duration;m(Z),F(X,Z),b.fallinObj=this,this.append=r,this.removeElem=s,this.resetOptions=l,this.activeFn=m,this.getMatrix=z,this.unbindResize=y,this.fallinIdx=Y,this.options=J,this.getOptions=I,this.itemsMove=o}function c(a,b){return a.left&&a.top&&b.left&&b.top&&a.left==b.left&&a.top==b.top?!0:!1}function d(a){var b,c,d=Number.MAX_VALUE,e=0;for(b=0,c=a.length;c>b;b++)a[b]<d&&(d=a[b],e=b);return e}function e(a){var b,c,d=Number.MIN_VALUE;for(b=0,c=a.length;c>b;b++)a[b]>d&&(d=a[b]);return d}function f(a,b,c){for(var d in b)if(!g(d,c)){var e=b[d];switch(typeof e){case"string":"string"!=typeof a[d]&&(a[d]=e);break;case"number":"number"!=typeof a[d]&&(isNaN(a[d])?a[d]=e:a[d]=Number(a[d]));break;case"boolean":"boolean"!=typeof a[d]&&(a[d]=Boolean(a[d]))}}}function g(a,b){var c,d,e=!1;if(!(b&&b instanceof Array&&b.length))return e;for(c=0,d=b.length;d>c;c++)if(b[c]==a){e=!0;break}return e}if(a){window.console||(console={log:function(){},error:function(){}}),a.easing.easeOutCubic||a.extend(a.easing,{easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c}});var h={cont:"fallin_wrap",item:"fallin_item",ignore:"fallin_ignore",empty:"fallin_empty",adding:"fallin_adding",sizer:"fallin_sizer",added:"fallin_added_",remove:"fallin_remove_"},i={empty:'<div class="'+h.item+" "+h.empty+" "+h.ignore+'"></div>'},j={type:"grid",itemSelector:"."+h.item,gridWidth:0,gridHeight:0,marginWidth:0,marginHeight:0,containerHeightControl:!0,align:"center",easing:"easeOutCubic",skipFirstMotion:!0,fillEmpty:!1,duration:500},k=0;window.Fallin=b,b.defaultOptions=j;var l={init:function(a){return this.each(function(c,d){d.fallinObj=new b(d,a)})},append:function(a,b){return this.each(function(c,d){d.fallinObj&&d.fallinObj.append(a,b)})},resetOptions:function(a){return this.each(function(b,c){c.fallinObj&&c.fallinObj.resetOptions(a)})},getFallinObject:function(){if(1==this.length)return this[0].fallinObj;if(this.length>1){var a=[];return this.each(function(b,c){a.push(c.fallinObj)}),a}return!1},getOptions:function(){return this[0].fallinObj.getOptions()},getMatrix:function(){return this[0].fallinObj.getMatrix()}};a.fn.fallin=function(b){return l[b]?l[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jquery.fallin"):l.init.apply(this,arguments)},a(function(){a(".fallin_wrap").each(function(c,d){var e,f=a(d).data("fallin-options");f&&f.constructor!==Object&&(console.error("fallin : options은 JSON 형태로 입력해주세요."),f=null),d.fallinObj=new b(d,e)})})}}(jQuery);