/* 2015-06-07 */ !function(a){function b(f,g){function h(a){console.log("activeFn"),"undefined"==typeof a&&(a=D.duration),B=0,i(),l(contHeight,a),j(a)}function i(){v=u(),w=E.width(),x=s("width"),y=s("height"),z=p(),"square"==D.type?(A=[],A.push(q(x,w)),v.each(function(b,c){var d=a(c);if(d.length){var e,f,g,h,i,j,k,l=Math.ceil(d.outerWidth()/(x+D.marginWidth)),m=Math.ceil(d.outerHeight()/(y+D.marginHeight)),n=!1;for(e=0;e<A.length;e++){for(f=0;f<A[e].length;f++){if(j=0===A[e][f]&&f+l<=A[e].length){var o=0;for(g=f;g<A[e].length;g++)if(o++,l>=o&&1==A[e][g]){j=!1;break}}if(j&&(k=e==A.length-1||1==m,!k)){var p=!0;for(g=e;g<A.length;g++)if(1==A[g][f]){p=!1;break}k=p}if(j&&k){n=!0;break}}if(n)break}for(n||(e=A.length,f=0),h=0;l>h;h++)for(i=0;m>i;i++)A[i+e]||A.push(q(x,w)),A[e+i][f+h]=1;d.data({"fallin.tx":f*(x+D.marginWidth),"fallin.ty":e*(y+D.marginHeight)}),console.log(d.data()),D.containerHeightControl&&(contHeight=A.length*(y+D.marginHeight)-D.marginHeight)}})):"rectangle"==D.type&&(A=q(),v.each(function(b,d){var e=a(d),f=c(A);e.data({"fallin.tx":f*(x+D.marginWidth),"fallin.ty":A[f]}),A[f]+=e.outerHeight(!0)+D.marginHeight}),D.containerHeightControl&&(contHeight=d(A)-D.marginHeight))}function j(b){v.each(function(c,d){k(a(d),b)})}function k(a,b){a.stop();var c={left:a.data("fallin.tx"),top:a.data("fallin.ty")};b?a.animate(c,{easing:D.easing,duration:b}):a.css(c)}function l(a,b){w=E.width(),F.stop();var c={left:r(),width:p()*(x+D.marginWidth)-D.marginWidth};D.containerHeightControl&&a&&(c.height=a),b?F.animate(c,{easing:D.easing,duration:b}):F.css(c)}function m(b,c){var d=a.extend({},{from:"default",fromElem:null,fromLeft:0,fromTop:0,effect:"default",duration:300},c);if("element"==d.from){var e=d.fromElem;e&&(e instanceof a||e.nodeName)||(d.from="default")}var f="fallin_added_default";"fadeIn"==d.effect&&(f="fallin_added_fadeIn");var g,j,m,n,o,p=a(b).css("position","absolute"),q=0;t();switch(d.from){case"left":g=0,j=F.height()+D.marginHeight;break;case"right":g=F.width()-s("height"),j=F.height()+D.marginHeight;break;case"end":m=u().filter(":last").offset(),n=F.offset(),g=m.left-n.left,j=m.top-n.top;break;case"pos":g=d.fromLeft,j=d.fromTop;break;case"element":}"default"!=d.from&&(q=d.duration,o=d.delay,p.css({left:g,top:j,visibility:"hidden"})),F.append(p),o?(p.addClass("fallin_adding"),i(),l(contHeight,q),u().filter(":not(.fallin_adding)").each(function(b,c){k(a(c),q)}),p.removeClass("fallin_adding"),p.each(function(b,c){var e=a(c);setTimeout(function(){"element"==d.from&&(m=a(d.fromElem).offset(),n=F.offset(),g=m.left-n.left,j=m.top-n.top,e.css({left:g,top:j})),e.css("visibility","visible").addClass(f),k(e,q)},d.delay*b)})):(p.addClass(f).css("visibility","visible"),h(q))}function n(b){D=a.extend({},e,b),h()}function o(){return A}function p(){var a=E.width(),b=D.marginWidth,c=s("width"),d=Math.floor((a+b)/(c+b));return d>v.length&&(d=v.length),d}function q(){for(var a=[],b=0,c=p();c>b;b++)a.push(0);return a}function r(){var a=0,b=E.width(),c=D.marginWidth,d=s("width"),e=p(),f=b-(e*(d+c)-c);return"center"==D.align?a=f/2:"right"==D.align&&(a=f),a}function s(b){var c="itemWidth",d="outerWidth";if("height"==b&&(c="itemHeight",d="outerHeight"),D[c])return D[c];var e=F.find(".default_item");if(e.length)return e[d]();var f=Number.MAX_VALUE;return F.find(D.itemElem).each(function(b,c){var e=a(c)[d]();e>=10&&f>e&&(f=e)}),f!=Number.MAX_VALUE&&f||(f=100),f}function t(){return D.type}function u(){return F.find(D.itemElem).filter(":not(.default_item)")}var v,w,x,y,z,A,B,C,D=a.extend({},e,g),E=f instanceof a?f:a(f),F=a('<div class="fallin_container" />');E.addClass("fallin_wrap"),E.find("> *").length&&F.append(E.find("> *")).appendTo(E),F.css("position","relative"),u().css("position","absolute"),a(window).bind("resize.fallin",function(){C&&clearTimeout(C),C=setTimeout(function(){var a=w!=E.width(),b=z!=p(),c=x!=s("width")||y!=s("height"),d=b||c;d?h():a&&"left"!=D.align&&l()},50)});var G=D.skipFirstMotion?0:D.duration;h(G),f.fallinObj=this,this.activeFn=h,this.append=m,this.resetOptions=n,this.getMetrix=o,this.itemsMove=j,b.counter++}function c(a){var b,c,d=Number.MAX_VALUE,e=0;for(b=0,c=a.length;c>b;b++)a[b]<d&&(d=a[b],e=b);return e}function d(a){var b,c,d=Number.MIN_VALUE;for(b=0,c=a.length;c>b;b++)a[b]>d&&(d=a[b]);return d}if(a){var e={type:"square",itemWidth:0,itemHeight:0,itemElem:"> *",marginWidth:10,marginHeight:10,containerHeightControl:!0,align:"center",easing:"easeOutCubic",skipFirstMotion:!0,duration:500};window.Fallin=b,b.counter=0;var f={init:function(a){return this.each(function(c,d){d.fallinObj=new b(d,a)})},append:function(a,b){return this.each(function(c,d){d.fallinObj&&d.fallinObj.append(a,b)})},resetOptions:function(a){return this.each(function(b,c){c.fallinObj&&c.fallinObj.resetOptions(a)})},getFallinObject:function(){if(1==this.length)return this[0].fallinObj;if(this.length>1){var a=[];return this.each(function(b,c){a.push(c.fallinObj)}),a}return!1}};a.fn.fallin=function(b){return f[b]?f[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jquery.fallin"):f.init.apply(this,arguments)},a(function(){a(".fallin_wrap").each(function(c,d){var e,f=a(d).data("fallin-options");f&&f.constructor!==Object&&(console.error("fallin : options은 JSON 형태로 입력해주세요."),f=null),d.fallinObj=new b(d,e)})}),a.easing.easeOutCubic||a.extend(a.easing,{easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c}})}}(jQuery);